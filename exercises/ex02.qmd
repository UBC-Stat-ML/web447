---
title: "Exercise 2: Bayes estimator"
editor: 
  mode: source
---
  
{{< include ../_macros.qmd >}}

## Goals

- Build a probability model for a concrete example.
- Introduce the concept of Bayes estimators.
- Review conditioning and Bayes rule.

## Setup

This exercise is centered around the following scenario:
  
{{< include ../blocks/_delta.qmd >}}


## Q.1: define a probabilistic model

1. What are the unknown quantities in this scenario? And what is the data?

In order to perform inference on the unknown quantities, we must specify how
they relate to the data; i.e., we need a *probabilistic model*.
Assume that every Delta 7925H rocket has the same probability $p$ of failing.
For simplicity, let us assume that $p$ is allowed to take values on an evenly space grid
$$
p \in \left\{\frac{k}{K}: k\in \{0,\dots,K\}\right\}
$$
for some fixed $K\in\nats$. Furthermore, we have access to a collection of
numbers $\rho_k\in[0,1]$ such that
$$
\forall k\in\{0,\dots,K\}:\ \pr\left(p=\frac{k}{K}\right) = \rho_k.
$$

Let $Z_i$ denote a binary variable indicating a failed launch. We assume that,
conditionally on $p$, these binary variables are independent of each other.

2. Write the joint distribution of this model (use the $\sim$ notation).


## Q.2: probability calculations

1. Give an expression for the prior predictive probability of failure for the 
next launch
$$
\pr(Z_4=1)
$$

2. Give an expression for the posterior probability
$$
\pr\left(p=\frac{k}{K}\middle| Z_1=Z_2=Z_3=0 \right)
$$

3. Give an expression for the posterior predictive probability
$$
\pr\left(Z_4=1 \middle| Z_1=Z_2=Z_3=0 \right)
$$
